buildscript {
  ext.kotlin_version = '1.0.0-rc-1036'
  ext.kotlin_xml_dsl_version = '0.1.4'
  ext.kotlin_xml_bind_version = '0.1.5'

  ext.local_maven_repo = "$rootProject.buildDir.canonicalPath/repo"

  repositories {
    mavenCentral()
    maven {
      url uri(local_maven_repo)
    }
  }

  dependencies {
    classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"
    //classpath "org.jonnyzzz.teamcity.dsl:gradle-plugin:SNAPSHOT"
  }
}

plugins {
  id "com.jfrog.bintray" version "1.5"
}

subprojects {
  apply plugin: 'java'
  apply plugin: 'kotlin'

  group = 'org.jonnyzzz.teamcity.dsl'

  sourceCompatibility = 1.8
  targetCompatibility = 1.8

  repositories {
    mavenCentral()
    maven { url "http://dl.bintray.com/jonnyzzz/maven" }
  }

  version = project.hasProperty('teamcity') ? project['teamcity']['build.number'] : 'SNAPSHOT'
}

task wrapper(type: Wrapper) {
  gradleVersion = '2.10'
}

task bintrayUploadEx {
  dependsOn ':DSL:bintrayUpload'
}

task localUploadEx {
  dependsOn ':DSL:publishToLocalMaven'
}
